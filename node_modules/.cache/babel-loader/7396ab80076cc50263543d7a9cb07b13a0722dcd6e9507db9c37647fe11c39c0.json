{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ValidateCollectionOperation = void 0;\nconst error_1 = require(\"../error\");\nconst command_1 = require(\"./command\");\n/** @internal */\nclass ValidateCollectionOperation extends command_1.CommandOperation {\n  constructor(admin, collectionName, options) {\n    // Decorate command with extra options\n    const command = {\n      validate: collectionName\n    };\n    const keys = Object.keys(options);\n    for (let i = 0; i < keys.length; i++) {\n      if (Object.prototype.hasOwnProperty.call(options, keys[i]) && keys[i] !== 'session') {\n        command[keys[i]] = options[keys[i]];\n      }\n    }\n    super(admin.s.db, options);\n    this.options = options;\n    this.command = command;\n    this.collectionName = collectionName;\n  }\n  async execute(server, session) {\n    const collectionName = this.collectionName;\n    const doc = await super.executeCommand(server, session, this.command);\n    if (doc.result != null && typeof doc.result !== 'string') throw new error_1.MongoUnexpectedServerResponseError('Error with validation data');\n    if (doc.result != null && doc.result.match(/exception|corrupt/) != null) throw new error_1.MongoUnexpectedServerResponseError(`Invalid collection ${collectionName}`);\n    if (doc.valid != null && !doc.valid) throw new error_1.MongoUnexpectedServerResponseError(`Invalid collection ${collectionName}`);\n    return doc;\n  }\n}\nexports.ValidateCollectionOperation = ValidateCollectionOperation;","map":{"version":3,"names":["Object","defineProperty","exports","value","ValidateCollectionOperation","error_1","require","command_1","CommandOperation","constructor","admin","collectionName","options","command","validate","keys","i","length","prototype","hasOwnProperty","call","s","db","execute","server","session","doc","executeCommand","result","MongoUnexpectedServerResponseError","match","valid"],"sources":["D:/web_project/node_modules/mongodb/lib/operations/validate_collection.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ValidateCollectionOperation = void 0;\nconst error_1 = require(\"../error\");\nconst command_1 = require(\"./command\");\n/** @internal */\nclass ValidateCollectionOperation extends command_1.CommandOperation {\n    constructor(admin, collectionName, options) {\n        // Decorate command with extra options\n        const command = { validate: collectionName };\n        const keys = Object.keys(options);\n        for (let i = 0; i < keys.length; i++) {\n            if (Object.prototype.hasOwnProperty.call(options, keys[i]) && keys[i] !== 'session') {\n                command[keys[i]] = options[keys[i]];\n            }\n        }\n        super(admin.s.db, options);\n        this.options = options;\n        this.command = command;\n        this.collectionName = collectionName;\n    }\n    async execute(server, session) {\n        const collectionName = this.collectionName;\n        const doc = await super.executeCommand(server, session, this.command);\n        if (doc.result != null && typeof doc.result !== 'string')\n            throw new error_1.MongoUnexpectedServerResponseError('Error with validation data');\n        if (doc.result != null && doc.result.match(/exception|corrupt/) != null)\n            throw new error_1.MongoUnexpectedServerResponseError(`Invalid collection ${collectionName}`);\n        if (doc.valid != null && !doc.valid)\n            throw new error_1.MongoUnexpectedServerResponseError(`Invalid collection ${collectionName}`);\n        return doc;\n    }\n}\nexports.ValidateCollectionOperation = ValidateCollectionOperation;\n//# sourceMappingURL=validate_collection.js.map"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,2BAA2B,GAAG,KAAK,CAAC;AAC5C,MAAMC,OAAO,GAAGC,OAAO,CAAC,UAAU,CAAC;AACnC,MAAMC,SAAS,GAAGD,OAAO,CAAC,WAAW,CAAC;AACtC;AACA,MAAMF,2BAA2B,SAASG,SAAS,CAACC,gBAAgB,CAAC;EACjEC,WAAWA,CAACC,KAAK,EAAEC,cAAc,EAAEC,OAAO,EAAE;IACxC;IACA,MAAMC,OAAO,GAAG;MAAEC,QAAQ,EAAEH;IAAe,CAAC;IAC5C,MAAMI,IAAI,GAAGf,MAAM,CAACe,IAAI,CAACH,OAAO,CAAC;IACjC,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,IAAI,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;MAClC,IAAIhB,MAAM,CAACkB,SAAS,CAACC,cAAc,CAACC,IAAI,CAACR,OAAO,EAAEG,IAAI,CAACC,CAAC,CAAC,CAAC,IAAID,IAAI,CAACC,CAAC,CAAC,KAAK,SAAS,EAAE;QACjFH,OAAO,CAACE,IAAI,CAACC,CAAC,CAAC,CAAC,GAAGJ,OAAO,CAACG,IAAI,CAACC,CAAC,CAAC,CAAC;MACvC;IACJ;IACA,KAAK,CAACN,KAAK,CAACW,CAAC,CAACC,EAAE,EAAEV,OAAO,CAAC;IAC1B,IAAI,CAACA,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACF,cAAc,GAAGA,cAAc;EACxC;EACA,MAAMY,OAAOA,CAACC,MAAM,EAAEC,OAAO,EAAE;IAC3B,MAAMd,cAAc,GAAG,IAAI,CAACA,cAAc;IAC1C,MAAMe,GAAG,GAAG,MAAM,KAAK,CAACC,cAAc,CAACH,MAAM,EAAEC,OAAO,EAAE,IAAI,CAACZ,OAAO,CAAC;IACrE,IAAIa,GAAG,CAACE,MAAM,IAAI,IAAI,IAAI,OAAOF,GAAG,CAACE,MAAM,KAAK,QAAQ,EACpD,MAAM,IAAIvB,OAAO,CAACwB,kCAAkC,CAAC,4BAA4B,CAAC;IACtF,IAAIH,GAAG,CAACE,MAAM,IAAI,IAAI,IAAIF,GAAG,CAACE,MAAM,CAACE,KAAK,CAAC,mBAAmB,CAAC,IAAI,IAAI,EACnE,MAAM,IAAIzB,OAAO,CAACwB,kCAAkC,CAAE,sBAAqBlB,cAAe,EAAC,CAAC;IAChG,IAAIe,GAAG,CAACK,KAAK,IAAI,IAAI,IAAI,CAACL,GAAG,CAACK,KAAK,EAC/B,MAAM,IAAI1B,OAAO,CAACwB,kCAAkC,CAAE,sBAAqBlB,cAAe,EAAC,CAAC;IAChG,OAAOe,GAAG;EACd;AACJ;AACAxB,OAAO,CAACE,2BAA2B,GAAGA,2BAA2B","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}